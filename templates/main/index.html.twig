{% extends 'base.html.twig' %}

{% block title %}Hello MainController!
{% endblock %}
{% block body %}
	<style>
		h5 {
			color: var(--lighter-purple-color);
		}
		.dot-status {
			width: 15px;
			height: 15px;
			border-radius: 50%;
			display: inline-block;
			margin-right: 10px;
			background-color: var(--new-ticket-color);
		}
		.main-section {
			border: none;
			border-radius: 4px;
		}
		.search-bar {
			border-radius: 4px;
			border: 1px solid #E7E7E7;
			background: #FBFBFB;
		}
		.choice-list {
			padding: 14px 13px 11px 18px;
			border-radius: 4px;
			border: 1px solid #E7E7E7;
		}
		.filter-buttons .btn {
			margin-right: 0.5rem;
		}
        .active-btn{
            color: var(--lighter-purple-color);
            border-bottom: 2px solid var(--lighter-purple-color);
        }
	</style>

	<div class="container-fluid">
		<h1>Page d'accueil</h1>
		<div class="card bg-white main-section">
			<div class="card-body">
				<div
					class="d-flex justify-content-between align-items-center mb-3">
					{# SEARCH BAR #}
					<form class="form-inline my-2 my-lg-0 d-flex flex-row">
						<input class="form-control mr-sm-2 search-bar" type="search" placeholder="Rechercher un ticket" aria-label="Search">
						<button class="btn my-2 my-sm-0 ms-2 btn-second" type="submit">Rechercher</button>
					</form>

					<div>
						{# STATUS FILTER #}
						<select class="custom-select mr-2 choice-list" onchange="updateActiveStatus(this)">
							{% for statu in status %}
								<option value="{{ statu.slug }}">{{ statu.label }}</option>
							{% endfor %}
						</select>
						{# DATE FILTER #}
						<select class="custom-select choice-list">
							<option selected>Cette semaine</option>
							<option value="1">Aujourd'hui</option>
							<option value="2">Ce mois</option>
						</select>
						<button class="btn btn-first">Nouveau ticket</button>
					</div>
				</div>

				{# ACTIVE STATUS #}
				<div class="border-bottom mb-4">
					<div class="filter-buttons mb-3 btn-group" role="group" aria-label="Basic example">
						{% for statu in status %}
							<button type="button" class="btn" data-status="{{ statu.slug }}">{{ statu.label }}</button>
						{% endfor %}
					</div>
				</div>
				{# TICKET #}
				{% for ticket in tickets %}
					<div class="card mb-4">
						<div class="card-body">
							<div class="d-flex align-items-center mb-3">
								<span class="rounded-circle dot-status"></span>
								<h5 class="m-0 flex-grow-1">{{ticket.title}}</h5>
								<span class="fs-6 fw-light">{{ ticket.createdAt|date('Y-m-d H:i') }}</span>
							</div>
							<div class="border-bottom pb-3 mb-3">
								<p>{{ticket.description}}</p>
							</div>
							<div class="d-flex align-items-center justify-content-between">
								<div class="d-flex align-items-center">
									<img src="#" alt="John Snow" class="rounded-circle me-2" width="50" height="50">
									<span class="name">{{ticket.user.pseudo}}</span>
								</div>
								<a href="#" class="">Ouvrir le ticket</a>
							</div>
						</div>
					</div>
				{% endfor %}

				{# PAGE #}
				{# <nav aria-label="Page navigation example">
					<ul class="pagination justify-content-center">
						<li class="page-item disabled">
							<a class="page-link" href="#" tabindex="-1" aria-disabled="true">Précédent</a>
						</li>
						<li class="page-item">
							<a class="page-link" href="#">1</a>
						</li>
						<li class="page-item">
							<a class="page-link" href="#">2</a>
						</li>
						<li class="page-item">
							<a class="page-link" href="#">Suivant</a>
						</li>
					</ul>
				</nav> #}
			</div>
		</div>
	</div>
</div>
<script>
function updateActiveStatus(selectElement) {
    var selectedStatus = selectElement.value;

    // Mettre à jour le statut actif sur les boutons
    var buttons = document.querySelectorAll('.filter-buttons .btn');
    buttons.forEach(function(button) {
        if(button.dataset.status === selectedStatus) {
            button.classList.add('active-btn');
        } else {
            button.classList.remove('active-btn');
        }
    });
}
</script>{% endblock %}
